using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Threading;
namespace Hilbert_curv_test
{
    class Program
    {

        static void Main(string[] args)
        {
            // use dots intead of commas
            Thread.CurrentThread.CurrentCulture = System.Globalization.CultureInfo.GetCultureInfo("en-US");
            // Calculate curve points
            Curve c = HilbertCurve.Hilbert(10);
            Console.WriteLine(c);
            c.ExportDataToTxt("hilbert.txt");
            Console.Read();

        }


    }

    public class HilbertCurve
    {

        private static Curve cur_curve;
        public static Curve Hilbert(int depth)
        {
           
            if (depth <= 0)
            {
                cur_curve = new Curve();

            }
            else
            {

                Curve temp = Hilbert(depth - 1);
                Curve prev_curve = new Curve { X = temp.X, Y = temp.Y };// Create new object instead of copying referece. 
   
      
                cur_curve.X = CalcXCoordinates(prev_curve);
                cur_curve.Y = CalcYCoordinates(prev_curve);
                cur_curve.Scale(.5);
            }
            return cur_curve;
        }
        //To do: lambda expressions instead of this massive with tons of loops
        #region Calculations on lists

        #region new coordinates of points
        private static List<double> CalcXCoordinates(Curve prev)
        {
            List<double> XCoordinates = new List<double>();
            XCoordinates.AddRange(IncreaseValues(prev.Y, -0.5));
            XCoordinates.AddRange(IncreaseValues(prev.X, -0.5));
            XCoordinates.AddRange(IncreaseValues(prev.X, 0.5));
            XCoordinates.AddRange(DecreaseValues(prev.Y, 0.5));

            return XCoordinates;
    }


         private static List<double> CalcYCoordinates(Curve prev)
        {
            List<double> YCoordinates = new List<double>();

            YCoordinates.AddRange(IncreaseValues(prev.X, -0.5));

            ICollection<double> temp = IncreaseValues(prev.Y, 0.5);
            YCoordinates.AddRange(temp);
            YCoordinates.AddRange(temp);
            YCoordinates.AddRange(DecreaseValues(prev.X, -0.5));

            return YCoordinates;
        }
        #endregion

        #region HelperMethods
        private static ICollection<double> DecreaseValues(List<double> X, double num)
        {
            ICollection<double> values = new List<double>(); 
            for (int i = 0; i < X.Count; i++)
            {
                values.Add(num - X[i]);
            }
             return values;
        }

        private static ICollection<double> IncreaseValues(List<double> X, double num)
        {
            ICollection<double> values = new List<double>();

            for (int i = 0; i < X.Count; i++)
            {

                values.Add(num + X[i]);
                
            }
            return values;
        }
        #endregion

        #endregion
    }

    public struct Point
    {
        public double X { get; set; }
        public double Y { get; set; }

    }
    public class Curve
    {
        

        public List<double> X { get; set; }
        public List<double> Y { get; set; }

        public Curve()
        {
            this.X = new List<double> { 0.0 };
            this.Y = new List<double> { 0.0 };
        }

        public void Scale(double num)
        {
            if(X.Count == Y.Count) { 
                  for (int i = 0; i < Y.Count; i++)
                  {
                      X[i] *= num;
                      Y[i] *= num;
                  }
            }
        }
        public override string ToString()
        {
            StringBuilder sbX = new StringBuilder();
            StringBuilder sbY = new StringBuilder();
            sbX.Append("X = [ ");
            sbY.Append("Y = [ ");
            if (X.Count == Y.Count)
            {
                for (int i = 0; i < X.Count; i++)
                {
                    sbX.Append(X[i]).Append(" ");
                    sbY.Append(Y[i]).Append(" ");
                }
            }
            sbX.Append("];");
            sbY.Append("];");

            sbX.Append(sbY);

            return sbX.ToString();
        }

        public void ExportDataToTxt(String path)
        {
            System.IO.File.WriteAllText(path, this.ToString());
        }
    }



}

